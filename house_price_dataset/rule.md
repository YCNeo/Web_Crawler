# Taipei Rent Dataset — **Current Data-Cleaning Rules**  
*(derived from the latest `src/clean.ts`, 2025-05-16 R3)*

---

## 1  Column Management  

| 類型                | 規則                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              |
| ------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **固定輸出順序**    | `編號`, `交易標的`, `鄉鎮市區`, `土地位置建物門牌`, `租賃年月日`, `總額元`, `出租型態`, `租賃期間天數`, `主要用途`, `租賃層次`, `總樓層數`, `建物型態`, `交易比棟數_土地`, `交易比棟數_建物`, `交易比棟數_車位`, `租賃住宅服務`, `有無管理組織`, `有無管理員`, `有無附傢俱`, `有無電梯`, `主要建材`, `建物現況格局-房`, `建物現況格局-廳`, `建物現況格局-衛`, `建物現況格局-隔間`, `都市土地使用分區`, `土地面積平方公尺`, `建物總面積平方公尺`, `單價元平方公尺`, `車位類別`, `車位面積平方公尺`, `車位總額元`, `建築完成年月`, `附屬設備_冷氣`, `附屬設備_熱水器`, `附屬設備_洗衣機`, `附屬設備_電視機`, `附屬設備_冰箱`, `附屬設備_瓦斯或天然氣`, `附屬設備_有線電視`, `附屬設備_網路`, `備註`, `source_file`<br>（若尚有其他欄位，追加在 `source_file` 之後） |
| **欄位移除**        | `非都市土地使用分區`, `非都市土地使用編定`, 原 `附屬設備`, 原 `租賃期間`, 原 `建築完成年月`                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       |
| **新增 / 重新命名** | * **`建築完成年月`** — ROC→`YYYY-MM-DD` 之字串<br>* **`租賃期間天數`** — 起迄日→天數（失敗 → `"NA"`）<br>* **`交易比棟數_土地 / 建物 / 車位`** — 數值<br>* **`附屬設備_{名稱}`** — 1/0                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            |

---

## 2  Value Conversions  

| 欄位             | 轉換規則                                                                                                                                                     |
| ---------------- | ------------------------------------------------------------------------------------------------------------------------------------------------------------ |
| **日期**         | ROC → 西元；支援 6/7 位純數字（含 `.0`）及 `/ . - 年月日` 分隔。<br>  • `租賃年月日` → `YYYY-MM-DD`；失敗刪列<br>  • `建築完成年月` → `YYYY-MM-DD`；失敗刪列 |
| **租賃期間天數** | `民國起日~迄日` → 日數；失敗 → `"NA"`                                                                                                                        |
| **租賃層次**     | `三層`→ 3、`四層`→ 4…；`地下X層`→ −X；`地下層`→ 0；其他 → `"NA"`                                                                                             |
| **交易比棟數**   | 欄位自動選 `租賃筆棟數` 或 `租賃比棟數`；可解析 `土地 1 建物0.5 車位0`、`1 1 0`、`1/1/0` 等多格式                                                            |
| **布林→1/0**     | `有無管理組織`, `有無管理員`, `有無附傢俱`, `有無電梯`, `建物現況格局-隔間`：「有」→ 1，「無」→ 0，其餘 → `"NA"`                                             |
| **主要建材**     | 空值 → `"NA"`                                                                                                                                                |
| **總額元**       | 去逗號轉數字；失敗刪列                                                                                                                                       |

---

## 3  Row-Deletion Criteria  

1. `主要用途` **不**含：住家用／住宅／集合住宅／多戶住宅／國民住宅／公寓／雙併住宅／農舍／住商用／住工用／宿舍／寄宿／住宿單元  
2. `建築完成年月` 解析失敗  
3. `租賃年月日` 解析失敗  
4. `建物現況格局-房` 或 `廳` 或 `衛` > 100  
5. `總額元` 解析失敗  

任何一條成立 ⇒ **整列剔除**。

---

## 4  Equipment Expansion  

* 全檔蒐集設備名稱 → 為每項建立 `附屬設備_{名稱}` (1/0)。  
* 原 `附屬設備` 欄拆分後刪除。

---

## 5  Miscellaneous  

* **CSV 讀取**：`dynamicTyping = false`（全部先以字串處理，避免自動轉 float）。  
* 空字串值保留；布林欄未知值 → `"NA"`。  
* **輸出檔**：`root/dataset/taipei_rent_clean.csv`（或由 CLI 指定路徑）。  
* **終端輸出**：各刪除理由筆數、總刪除、剩餘筆數與存檔路徑。
